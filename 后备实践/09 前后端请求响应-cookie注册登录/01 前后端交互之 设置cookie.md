# 前后端交互之 设置cookie

## 前言

用一个实现登录注册的小实践项目，来学习前后端之间如何交互，本篇主要是关于 如何设置cookie

目录

1 [实现思路](#1)

2 [具体实现](#2)


## <span id="1">一 实现思路</span>

1 Q: 后端如何响应请求url

A: S0.1 有一个 后台服务器处理脚本(如用node等语言写的 server.js)

S0.2 设置好一些基本网络处理的变量，如path、method、port、url等(了解即可)

S1 设置路由判断，当路径/方法 等满足条件时，就会 执行对请求的处理/返回错误等

这里判断当 请求url为sign-up时，就返回一个sign-up.html字符串(符合html语法)

S2 sign-up.html注册页面的 HTML结构和CSS样式


2 Q: 前端如何发送请求

A: 通过AJAX 发送请求&处理响应

S1 获取整个表单(而不是提交按钮!!)，监听点击事件: 取消默认行为

S2 获取输入按钮的集合 + 读取其中每个按钮的 文本内容（传给一个空对象中）

S3 引入Jquery— 调用AJAX,把输入的内容 作为数据传给服务器脚本处理（并用then处理 服务器响应）


3 Q: 后台如何处理请求 并返回响应

A: 通过路由设置，判断url路径+提交方法，如果是要处理的 请求路径+提交的方法

S1 通过Node.js的API,封装一个读取请求数据的函数,返回结果是字符串

S2 因为后台读取的结果是字符串，不便于根据请求传入的数据 进行后台处理判断，

所以，要把请求传入的字符串内容 转化为一个 对象

S3 读取对象内容，进行后台情况判断(返回正确/错误的响应内容-- JSON文本 和 响应header)  

S4 前端通过AJAX+then方法，获取到后台返回数据后(通常是JSON格式)，进行格式的显示处理


4 Q: 前端如何显示错误信息展示 + 在前端进行注册信息的判断

A: html新增div错误信息展示 +　发送AJAX前 进行信息判断

S1 div空文本，用于显示错误信息

S2 在提交事件监听内容，AJAX提交前，进行 前端注册内容判断


5 Q: 存储注册页面传入的数据—创建数据库

A: 可以用文本文件模拟数据库

S1 解决url的@转义问题— decodeURIComponent()方法

S2 创建文本数据库users记事本 + 数据格式转化读取数据库初始化内容 + 后台读取传输内容，编码后存入数据库中

S3 解决数据库内存入重复数据的问题

&emsp;&emsp;(1) 获取数据后，push数据前 先验证邮箱在数据库内是否已有（遍历循环+标识位）

&emsp;&emsp;(2) 如果已有，则忽略不push + 响应返回重复提示

&emsp;&emsp;(3) 如果未重复，则加入数据库文本中 + 响应返回正确提示


6 Q: 如何实现 登录页面的登录验证

A: 获取请求数据+数据库数据，进行对比

S1 新建sign-in登录html文件，内容基本同注册页面

S2 在后台设置sign-in的 url路由判断，get方法返回html字符串，post方法则进行验证

S3 读取请求数据(格式转化) + 读取数据库数据 + 进行数据对比，成功就返回成功信息等


7 Q: 如何在请求中携带cookie

S1 在响应中设置cookie响应头

S2 下一个请求中会自动携带cookie


## <span id="2">二 具体实现</span>

1 第一版: 初步实现 注册界面和注册验证

2 第二版: 数据库存储数据 + 添加登录页 + 设置cookie 





