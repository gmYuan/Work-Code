# 无缝轮播实现详解

## 一 轮播实现功能

1 多个大小相等的图片平铺

2 利用CSS布局只显示一张图片，其余隐藏

3 通过 计算偏移量+定时器 实现自动播放

4 通过手动点击事件 切换图片

5 点击分页器，切换图片

6 鼠标hover状态时停止自动播放

7 轮播间隔时间和图片切换时间 可在代码里直接改相关时间常量


## 二 具体实现

1 html部分

S0 整个轮播部分容器

S1 图片容器 + 单个slider-item + 链接 + 图片内容

S2 分页器按钮容器 + 按钮

S3 箭头容器 + 前后链接指示箭头

注意： S1步骤 图片首尾增加一张图片，即 4-1-2-3-4-1，以便形成无缝轮播效果


2 CSS部分

S0 reset样式 + 清除浮动样式

S1 让图片显示在一行

 (1) 设置slider-item宽高 + 浮动布局

 (2) 设置图片宽高100%

S2 只显示一张图片，隐藏其他图片

  (1) 设置 图片容器  宽度为图片宽度之和 + 高度为单个图片高度

  (2) 整个容器 宽高设为单个图片宽高 + overflow隐藏超出内容(否则子元素会超出父元素宽度)

S3 显示圆形分页器在一行 + 绝对定位在整个容器内

  (1) 显示为圆点: 宽+高+边框+border-radius

  (2) 显示为一行: 浮动 + 外边距(美观)

  (3) 分页器显示在 整个容器内: 相对+绝对定位+z-index

  (4) 设置点击/当前选中分页器背景色

S4 左右显示箭头

  (1) 总容器相对+箭头容器绝对定位+ 箭头设置宽高 & 左右绝对定位+z-index

  (2) 设置箭头颜色+大小

S5 绝对定位以控制轮播图片的切换

  (1) 图片容器绝对定位


3 JS部分

S1 点击箭头切换图片的效果

  (0) 总容器相对 + `图片容器绝对定位&设置style属性`，以便于JS操作轮播图片切换

  (1) 获取目标元素(图片容器 + 左右箭头)

  (2) 监听右点击事件: 向右点击时, 容器的left值 向右移动一张图片宽度

        监听左点击事件: 向左点击时, 与上类似

  (3) 以上重复代码，可以封装一个 自动切换图片函数:  切换容器左/右lfet值

  (4) 解决点击超过图片张数出现的空白问题：小于真实张数时，切换left到真实图


S2 点击箭头时圆点跟随切换

  (1) 获取圆点元素 + 用index表示节点状态

  (2) 节点函数: 当前圆点添加状态类

  (3) 节点函数: 清除之前节点状态类

  (4) 监听点击箭头事件
        当向右时，添加index值 + index判断不等于4,否则重置为1
          向左时，减少index值 + index判断不等于1，否则重置为4
          注意，左右事件互斥（不会同时触发，所以数据不影响）
      原因逻辑是:

Buttonindex 初始    触发事件后buttonindex      函数内buttonindex-1
  1                       未触发事件                 未触发事件
  1                          2                           1
  2                          3                           2
  3                          4                           3
  4                         归位为1                       0


S3 点击圆点，随之切换图片

  (1) 获取所有圆点 + 遍历按钮，监听每个圆点的  点击事件
  
  (2) 获取当前点击圆点的 data-index值（1~4）
      获取当前显示图片———— 即当前ButtonsIndex值
      两者之间的差值 乘以 单张图片宽度， 就是移动距离

  (3) 图片移动 + 当前Index更新 + 设置当前圆点高亮


S4 形成图片切换时的 动画效果

  (0) 首先明确: 一次动画 = 一个时间段内的多次周期运动(比如 1000ms内 运动 100次，每次运动花费10ms)
  
  (1) 所以 设置JS 切换一张图片的 运动总时长(1000ms) + 每次运动的时长(10ms)，两者相除 = 运动次数(100次)
      用 距离 / 运动次数(帧数) = 每次周期运动的长度 (每帧的距离)

  (2) 新建运动函数，递归调用运动函数：逐次增加移动距离
  
  (3) 移动图片时 默认调用动画效果
  
  (4) 优化连续多次点击的效果: 动画时禁止添加新动画 moving


S5 实现自动图片轮播

  （1）设置定时器+回调函数
  
  （2）当移入鼠标时，停止自动轮播


轮播组件JS的思路:

点击箭头showArrows—— 触发animate: move(移动动画：图片移动限制)
                    递增/减 this.index + 调用showbutton

显示按钮showbutton： 根据this.index给当前按钮添加on类 

按钮切换ctrlbutton： 根据按钮运动图片 + 更新index值 + 调用showbutton


自动播放autoplay + stopplay:  定时器自动调用next方法 + 打破定时器  + 移入时触发stop事件 + 移出&默认时 触发autoplay事件


## 三 参考文档

[01 原生js简单轮播图](https://www.cnblogs.com/LIUYANZUO/p/5679753.html)

[02 面向对象轮播](https://github.com/EtimeLEE/myLunbo)    